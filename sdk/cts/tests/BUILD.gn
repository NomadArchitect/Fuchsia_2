# Copyright 2020 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.
import("//build/zircon/c_utils.gni")
import("//sdk/ctf/build/ctf.gni")

group("tests_no_e2e") {
  testonly = true
  assert_no_deps = e2e_test_libs

  deps = [
    "//sdk/ctf/tests/fidl:tests",
    "//sdk/ctf/tests/pkg:tests",

    # Tests not under //sdk/ctf/...
    # TODO: Fix the below test in the CTS release
    #"//src/sys/component_manager/tests/collections:collections_integration_test",
    "//sdk/ctf/tests/tools:tests_no_e2e",
    "//src/sys/component_manager/tests/reboot_on_terminate:tests",
  ]
}

group("e2e_tests") {
  testonly = true
  deps = [ "//sdk/ctf/tests/tools:e2e_tests" ]
}

group("tests") {
  testonly = true
  deps = [
    ":e2e_tests",
    ":tests_no_e2e",
  ]
}

cts_unstripped_binaries_file = "$root_out_dir/cts_unstripped_binaries.list"
link_output_rspfile("cts_unstripped_binaries_list") {
  testonly = true
  outputs = [ cts_unstripped_binaries_file ]
  deps = [
    # TODO(chok): This currently contains a superset of unstripped binaries.
    # We will want to create a smaller group which only contains ctf_executable()'s.
    ":tests",
  ]
}

group("fidl_mangled_to_api_mapping") {
  testonly = true
  deps = [ "//sdk/ctf/tests:fidl_mangled_to_api_mapping" ]
}
