// Copyright 2022 The Fuchsia Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

use fuchsia_inspect::StringReference;

pub(super) const TOUCHPAD_EVENTS_ROOT: &'static str = "touchpad_events";

// Some keys are repeated for every event, which makes for an inefficient
// use of space in the Inspect VMO. Optimize that space by using
// `StringReference`s.
lazy_static::lazy_static! {
    pub(super) static ref EVENT_TIME: StringReference<'static> = "driver_monotonic_nanos".into();
    pub(super) static ref ENTRY_LATENCY: StringReference<'static> = "entry_latency_micros".into();
    pub(super) static ref PRESSED_BUTTONS: StringReference<'static> = "pressed_buttons".into();
    pub(super) static ref CONTACT_STATE: StringReference<'static> = "contacts".into();
    pub(super) static ref X_POS: StringReference<'static> = "pos_x_mm".into();
    pub(super) static ref Y_POS: StringReference<'static> = "pos_y_mm".into();
    // TODO(https://fxbug.dev/108886): normalize to mm.
    pub(super) static ref WIDTH: StringReference<'static> = "width_raw".into();
    pub(super) static ref HEIGHT: StringReference<'static> = "height_raw".into();
}

// Example JSON dump of inspect tree generated by `gesture_arena`, from a unit test:
//
// ```json
// {
//   "root": {
//     "touchpad_events": {
//       "0": {
//         "driver_monotonic_nanos": 12300,
//         "entry_latency_micros": 9987,
//         "pressed_buttons": [
//           1
//         ],
//         "contacts": {
//           "1": {
//             "pos_x_mm": 2.0,
//             "pos_y_mm": 3.0
//           },
//           "2": {
//             "pos_x_mm": 40.0,
//             "pos_y_mm": 50.0
//           }
//         }
//       },
//       "1": {
//         "driver_monotonic_nanos": 8000000,
//         "entry_latency_micros": 4000,
//         "pressed_buttons": [],
//         "contacts": {
//           "1": {
//             "height_raw": 40.0,
//             "pos_x_mm": 2.0,
//             "pos_y_mm": 3.0,
//             "width_raw": 30.0
//           }
//         }
//       }
//     }
//   }
// }
// ```

// Example `iquery` excerpt, showing just touchpad data, from a live device:
//
// ```json5
// touchpad_events:
//   149:
//     driver_monotonic_nanos = 118856910729
//     entry_latency_micros = 2564
//     pressed_buttons = []
//     contacts:
//       0:
//         height_raw = 646.000000
//         pos_x_mm = 30.590000
//         pos_y_mm = 20.351999
//         width_raw = 738.000000
//   150:
//     driver_monotonic_nanos = 118864822860
//     entry_latency_micros = 2435
//     pressed_buttons = []
// ```
